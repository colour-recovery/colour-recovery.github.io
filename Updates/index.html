<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="search" href="https://colour-recovery.github.io/space/opensearch" type="application/opensearchdescription+xml" title="Wikispaces Search (Colour Recovery Working Group Wiki)" />
<link rel="alternate" type="application/x-wiki" title="Edit This Page" href="/page/edit/Updates" />
<link rel="alternate" title="Colour Recovery Working Group - All Changes" href="https://colour-recovery.github.io/wiki/xmla?v=rss_2_0" type="application/rss+xml" />
<link rel="alternate" title="colour-recovery : Updates - Discussion" href="https://colour-recovery.github.io/message/xml/Updates?v=rss_2_0" type="application/rss+xml" />
<link rel="alternate" title="colour-recovery : Updates - Edits" href="https://colour-recovery.github.io/page/xml/Updates?v=rss_2_0" type="application/rss+xml" />
<link rel="microsummary" href="/page/microsummary/Updates/edits"/>
<link rel="microsummary" href="/page/microsummary/Updates/messages"/>
<script type="text/javascript">
  
if (typeof ws === 'undefined') ws = {};
ws.context = {
  instance: {
    id: '1',
    url: 'wikispaces.com',
    isMain: true,
    supportsGoogleDocs: false,
    isTesClassroom: false,
  },
  user: {
    id: '',
    username: '',
    status: '',
    locale: 'en',
    imageUrlPrefix: '../ssl.wikicdn.com/i/user_none_',
    isTeacher: false,
    canAdministerWiki: false,
  },
  wiki: {
    id: '110862',
    name: 'colour-recovery',
    text: 'Colour Recovery Working Group',
    module: 'B',
    isClassroom: false,
    isTesClassroom: false
    ,defaultSpaceId: 110862
    ,isWwwWiki: false
  },
  project: {
    id: '110862',
    name: ''
  },
  space: {
    id: '110862',
    name: 'colour-recovery',
    isDefaultSpace: true,
    isDefaultTemplate: false
  },

  environment_name: 'prod',

  path: {
    object: 'page',
    method: 'view',
    page: 'Updates',
    id: ''
  },

  settings: {
    main_domain: 'wikispaces.com',
    session_url: 'https://session.wikispaces.com/1/',
    asset_url_prefix: '../ssl.wikicdn.com',
    beta_features: false,
    isMobileSite: false,
    isUploadCapable: true,
    can_discuss: false,
    has_gdocs: false,
    isDialog: false,
    pwin: ''
  },
  clockSkewMillis: 1528198261614 - ((window.performance && window.performance.timing.responseStart > 0) ? window.performance.timing.responseStart : (new Date()).getTime())
}


// legacy javascript API variables, use the above instead
var wikispaces_isUserLoggedIn = !!ws.context.user.id;
var wikispaces_isMain = ws.context.instance.isMain;
var wikispaces_username = ws.context.user.username;
var wikispaces_spaceName = ws.context.space.name;
var wikispaces_projectName = ws.context.project.name;
var wikispaces_wikiName = ws.context.wiki.name;
var wikispaces_wikiText = ws.context.wiki.text;
var wikispaces_isDefaultSpace = ws.context.space.isDefaultSpace;
var wikispaces_method = ws.context.path.method;
var wikispaces_object = ws.context.path.object;
var wikispaces_page = ws.context.path.page;
var wikispaces_id = ws.context.path.id;
var wikispaces_domain = ws.context.instance.url;
var wikispaces_isUserOrganizer = false;
var wikispaces_main_domain = ws.context.settings.asset_url_prefix;
var wikispaces_asset_url_prefix = ws.context.settings.asset_url_prefix;
var wikispaces_beta_features = ws.context.settings.beta_features;
var wikispaces_isMobileSite = ws.context.settings.isMobileSite;
var wikispaces_isUploadCapable = ws.context.settings.isUploadCapable;
var wikispaces_can_discuss = ws.context.settings.can_discuss;
var wikispaces_has_gdocs = ws.context.settings.has_gdocs;

</script><title>Colour Recovery Working Group - Updates</title>
<meta charset="utf-8" />
<link rel="apple-touch-icon" sizes="144x144" href="../ssl.wikicdn.com/_/z6371z4x/i/logo-144.png" />
<link rel="apple-touch-icon" sizes="114x114" href="../ssl.wikicdn.com/_/j5j77xz3/i/logo-114.png" />
<link rel="apple-touch-icon" sizes="72x72" href="../ssl.wikicdn.com/_/vq8j5432/i/logo-72.png" />
<link rel="apple-touch-icon" href="../ssl.wikicdn.com/_/38515190/i/logo-57.png" />
<link rel="shortcut icon" href="../ssl.wikicdn.com/_/55v9k02z/i/logo-16.png" />
<style type="text/css">
/*
Based on: AquaFluid, http://wpthemepark.com/
Description: WP Theme AquaFluid by Sadish
Version: 1.0
Author: Sadish Balasubramanian
*/

/* Standard theme styles */
*, *:before, *:after {
  -webkit-box-sizing: border-box;
     -moz-box-sizing: border-box;
          box-sizing: border-box;
}
body {
  font-family: arial, helvetica, sans-serif;
  font-size: 14px;
  line-height: 20px;
  margin: 0;
}
.ws-theme-header-inner,
.ws-theme-body-inner,
.ws-theme-footer-inner,
.ws-theme-content-inner,
.ws-theme-sidebar-inner {
  position: relative;
}
.ws-theme-header-inner:after,
.ws-theme-body-inner:after,
.ws-theme-footer-inner:after,
.ws-theme-content-inner:after,
.ws-theme-sidebar-inner:after,
.ws-theme-menu-inner:after {
  content: " ";
  visibility: hidden;
  display: block;
  height: 0;
  clear: both;
}
.ws-theme-content, .ws-theme-sidebar {
  overflow-x: auto;
}
.ws-theme-footer {
  text-align: right;
}
.ws-theme-footer a, .ws-theme-footer a:hover {
  text-decoration: none;
}
@media (min-width: 768px) {
  .ws-theme-container {
    width: 750px;
    margin-right: auto;
    margin-left: auto;
  }
  .ws-theme-content {
    width: 550px;
    min-height: 384px;
    float: right;
  }
  .ws-theme-sidebar {
    width: 200px;
    float: left;
  }
}
@media (min-width: 992px) {
  .ws-theme-container {
    width: 970px;
  }
  .ws-theme-content {
    width: 770px;
    min-height: 496px;
  }
}
@media (min-width: 1200px) {
  .ws-theme-container {
    width: 1170px;
  }
  .ws-theme-content {
    width: 970px;
    min-height: 600px;
  }
}
/* End standard theme styles */
</style>
<style type="text/css">
/* Theme-specific styles */
body {
  background-color: #CDE;
}

.ws-theme-container {
  margin: 0 5px;
}

.ws-theme-header .WikiSearch .WikiSearchInput,
.ws-theme-sidebar .WikiSearch .WikiSearchInput,
.ws-theme-footer .WikiSearch .WikiSearchInput {
  width: 100%;
}

.ws-theme-header,
.ws-theme-sidebar,
.ws-theme-footer {
  color: #000000;
}
.ws-theme-header a,
.ws-theme-sidebar a,
.ws-theme-footer a {
  color: #0000FF;
  text-decoration: none;
}
.ws-theme-header a:hover,
.ws-theme-sidebar a:hover,
.ws-theme-footer a:hover {
  text-decoration: underline;
}
.ws-theme-header img,
.ws-theme-sidebar img,
.ws-theme-footer img {
  border: none;
}

.ws-theme-header-inner,
.ws-theme-body-inner,
.ws-theme-footer-inner {
  border: #CCC 1px solid;
}

.ws-theme-header,
.ws-theme-sidebar {
  display: none;
}

.ws-theme-body {
  padding-top: 8px;
}
.ws-theme-body-inner {
  border-bottom: none;
  background-color: #FFF;
}

.ws-theme-content {
  overflow-x: visible;
}
.ws-theme-content-inner {
  padding: 13px 15px 26px;
}

.ws-theme-footer {
  font-size: 12px;
  text-align: center;
  padding-bottom: 8px;
}
.ws-theme-footer-inner {
  padding: 10px 15px;
  background: #FFF;
  border-top-color: #000;
}
.ws-theme-footer .WikiLicense img {
  vertical-align: text-bottom;
}

@media (min-width: 768px) {
  body {
    background: #FAFBFC url(../ssl.wikicdn.com/_/68jv1944/i/theme_aqua_blue.jpg) repeat-x top fixed;
  }

  .ws-theme-container {
    width: auto;
    margin: 0 8px;
  }

  .ws-theme-header,
  .ws-theme-sidebar {
    display: block;
  }

  .ws-theme-header {
    display: block;
    padding-top: 20px;
  }
  .ws-theme-header-inner {
    height: 125px;
    padding: 25px 20px;
    background: #483d8b url(../ssl.wikicdn.com/_/xq2j142v/i/theme_aqua_header.jpg) repeat-x bottom;
    border-bottom: none;
  }
  .ws-theme-header .ws-theme-logo {
    float: right;
  }

  .ws-theme-body {
    padding-top: 0;
  }
  .ws-theme-body-inner {
    border-top: none;
    background-color: #EEE;
  }
  .ws-theme-body-inner:before {
    content: " ";
    display: block;
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 200px;
    background-color: #FFF;
    border-left: 1px solid #CCC;
  }

  .ws-theme-content {
    width: auto;
    margin-left: 200px;
    float: none;
  }
  .ws-theme-content-inner {
    float: left;
    width: 100%;
    padding: 13px 15px 26px;
  }

  .ws-theme-sidebar-inner {
    padding: 0 10px;
  }
  .ws-theme-sidebar .WikiActions {
    list-style-type: none;
    padding: 0;
    margin: 0;
  }
  .ws-theme-sidebar .WikiActions > li {
    padding: 2px;
  }
  .ws-theme-sidebar .WikiCustomNav ol {
    padding-left: 16px;
  }
  .ws-theme-sidebar .WikiCustomNav ol.includePageList {
    padding-left: 0;
  }
  .ws-theme-sidebar .WikispacesNavbar {
    margin: 0 -10px;
    padding: 0 10px;
  }
  .ws-theme-sidebar .ws-theme-nav-edit {
    color: #666;
    text-align: center;
  }
  .ws-theme-sidebar .ws-theme-nav-edit a {
    color: inherit;
  }

  .ws-theme-footer-inner {
    border-top-color: #CCC;
    background: #FFF url(../ssl.wikicdn.com/_/2z687q19/i/theme_aqua_top.gif) repeat-x top;
  }
}

/* End theme-specific styles */
</style>
<link rel="stylesheet" href="../www.wikispaces.com/stylesheet/viewi/217420326D.css" type="text/css" />
<link rel="stylesheet" href="../ssl.wikicdn.com/s/nogz/9jvvjv40-internal-bootstrap.css" type="text/css" />
<link rel="stylesheet" href="../ssl.wikicdn.com/s/nogz/vz033906-internal.css" type="text/css" />
<script src="../ssl.wikicdn.com/s/nogz/84014v41-top.min.js" type="text/javascript"></script>

<script type="text/javascript">
  var _gaq = _gaq || [];

  var wsGoogleAccount = 'UA-80504-1';
  _gaq.push(['_setAccount', wsGoogleAccount]);
  _gaq.push(['_gat._anonymizeIp']);
  _gaq.push(['_setDomainName', 'wikispaces.com']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_setCustomVar', 2, 'Authenticated', 'Guest', 2]);
  _gaq.push(['_trackPageview']);
</script></head>
<body><a href="#WikiContent" class="hidden sr-only sr-only-focusable">Skip to main content</a><div id="js-fixed-header-holder" class="fixed"><div class="WikispacesContent WikispacesBs3" role="banner">
      
    <div class="ws-main-top-nav visible-xs">
    <div class="navbar navbar-static-top" style="margin-bottom: 0;">
      <div class="container">
                <div class="navbar-header">
          <div class="visible-xs pull-left">
            <a href="/space/menu" class="WikispacesDialogLink btn navbar-btn">
              <i class="fa fa-bars"></i>
            </a>
          </div>
          <div class="visible-xs pull-right js-globalnav-popover-container">
                        <a href="../www.wikispaces.com/site/signin?goto=https%3A%2F%2Fcolour-recovery.wikispaces.com%2FUpdates%3FresponseToken%3D891fc83df167d9cbae86691b4e187d75" class="btn navbar-btn ws-mobile-guest-username js-globalnav-popover-trigger">
              guest
            </a>
                        <div class="hidden js-globalnav-popover-content">
              <div class="WikispacesContent WikispacesBs3">
                <div class="WikiInternalHeaderNav noHide">
  <div class="WikiInternalHeaderNavMenu">
                          
                  <span class="WikiInternalHeaderNavMenuArea"><a href="../www.wikispaces.com/user/join?goto=https%3A%2F%2Fcolour-recovery.wikispaces.com%2Fspace%2Fjoin" rel="nofollow" class="WikispacesXDomainDialogLink">Join</a></span>

          <span class="divider">|</span>
        
        <span class="WikiInternalHeaderNavMenuArea"><a class="js-help-trigger" rel="nofollow" href="http://helpcenter.wikispaces.com/">Help</a></span>

        <span class="divider">|</span>
      
      <span class="WikiInternalHeaderNavMenuArea"><a href="../www.wikispaces.com/site/signin?goto=https%3A%2F%2Fcolour-recovery.wikispaces.com%2FUpdates%3FresponseToken%3D891fc83df167d9cbae86691b4e187d75" rel="nofollow" class="WikispacesXDomainDialogLink">Sign In</a></span>
      </div>
</div>              </div>
            </div>
          </div>
          <div class="ws-navbar-middle-xs">
            <div class="navbar-brand" role="navigation">
              <a href="../www.wikispaces.com/" class="ws-logo"></a>
              <i class="fa fa-angle-right"></i>
              <a href="https://colour-recovery.github.io/">Colour Recovery Working Group</a>
                              <i class="fa fa-angle-right"></i> <a href="https://colour-recovery.github.io/home">Home</a>
              
            </div>
          </div>
                    <form action="/search/view" method="post" class="navbar-form ws-include-xs pull-left ws-navbar-search hidden-xs" role="search"><input type="hidden" name="wikispacesFormToken" value="57da8de35c3bcb2e8f6c4a3a783f60c28b3836cf"/><input type="text" class="form-control search-query" name="q" value="" placeholder="Search" /> </form>
                  </div>
      </div>
    </div>
  </div>
      <div class="hidden-xs"><div class="WikiInternalHeaderNav WikiElement floating">
  <div class="WikiInternalHeaderNavMenu">
                                    <span class="WikiInternalHeaderNavMenuArea guestUserName">guest</span><span class="slideMarker divider">|</span>
        
                  <span class="WikiInternalHeaderNavMenuArea"><a href="../www.wikispaces.com/user/join?goto=https%3A%2F%2Fcolour-recovery.wikispaces.com%2Fspace%2Fjoin" rel="nofollow" class="WikispacesXDomainDialogLink">Join</a></span>

          <span class="divider">|</span>
        
        <span class="WikiInternalHeaderNavMenuArea"><a class="js-help-trigger" rel="nofollow" href="http://helpcenter.wikispaces.com/">Help</a></span>

        <span class="divider">|</span>
      
      <span class="WikiInternalHeaderNavMenuArea"><a href="../www.wikispaces.com/site/signin?goto=https%3A%2F%2Fcolour-recovery.wikispaces.com%2FUpdates%3FresponseToken%3D891fc83df167d9cbae86691b4e187d75" rel="nofollow" class="WikispacesXDomainDialogLink">Sign In</a></span>
      </div>
</div></div>
  </div></div><div id="js-fixed-header-offset">
<header class="ws-theme-header" role="banner">
  <div class="ws-theme-container">
    <div class="ws-theme-header-inner">
      <div class="ws-theme-logo">
        <a href="https://colour-recovery.github.io/" class="WikiLogo WikiElement"><img src="../logo.jpg" alt="Colour Recovery Working Group" /></a>      </div>
    </div>
  </div>
</header>

<div class="ws-theme-body">
  <div class="ws-theme-container">
    <div class="ws-theme-body-inner">
      <nav class="ws-theme-sidebar" role="navigation">
        <div class="ws-theme-sidebar-inner">
          <div class="ws-theme-menu">
            <div class="ws-theme-menu-inner">
              <ul class="WikiActions WikiElement WikiControls">
    <li id="WikiActionHome"><div><span class="WikiActionSupplemental" style="float: right;"></span><a href="https://colour-recovery.github.io/"><i class="fa fa-home fa-fw"></i></a><a href="https://colour-recovery.github.io/">Wiki Home</a></div></li>
    <li id="WikiActionChanges"><div><span class="WikiActionSupplemental" style="float: right;"></span><a href="/wiki/changes"><i class="fa fa-clock-o fa-fw"></i></a><a href="/wiki/changes">Recent Changes</a></div></li>
    <li id="WikiActionPagesAndFiles"><div><span class="WikiActionSupplemental" style="float: right;"></span><a href="/space/content"><i class="fa fa-file-text-o fa-fw"></i></a><a href="/space/content">Pages and Files</a></div></li>
    <li id="WikiActionMembers"><div class="js-member-link"><span class="WikiActionSupplemental" style="float: right;"></span><a href="/wiki/members"><i class="fa fa-user fa-fw"></i></a><a href="/wiki/members">Members</a></div></li>
</ul>
              <form action="/search/view" method="post" class="WikiSearch WikiElement" role="search"><input type="text" class="form-control WikiSearchInput" name="q" value="" placeholder="Search" /> </form>              <div class="WikiCustomNav WikiElement wiki"><ul><li><h3><a class="wiki_link" href="/Home">Home</a></h3>
</li><li><a class="wiki_link_ext" href="http://colour-recovery.github.io/message/list/home" rel="nofollow">General Announcements</a></li><li><a class="wiki_link" href="/Members">Members</a></li><li><a class="wiki_link" href="/An%20examination%20of%20source%20material">An examination of source material</a></li><li><a class="wiki_link" href="/Background%20information">Background information</a></li><li><a class="wiki_link" href="/Tutorials">Tutorials</a></li><li><a class="wiki_link" href="/Utilities">Utilities</a></li><li><a class="wiki_link" href="/Previous%20work">Previous work</a></li><li><a class="wiki_link" href="/Current%20work">Current work</a></li><li><a class="wiki_link" href="/Future%20work">Future work</a></li></ul></div>              <div class="ws-theme-nav-edit">
                              </div>
            </div>
          </div>
        </div>
      </nav>
      <main class="ws-theme-content" role="main">
        <div class="ws-theme-content-inner">
          <div class="contentBox"><div class="innerContentBox" id="WikiContent">

<script type="text/template" id="comment-footer-template">

<div class="commentFooter modal-footer">
  <div class="pull-left">
    <button type="button" class="btn btn-default btn-sm previous"><i class="fa fa-arrow-left"></i></button>
    <button type="button" class="btn btn-default btn-sm next"><i class="fa fa-arrow-right"></i></button>
  </div>
  <% if (ws.context.user.canAdministerWiki && !ws.comments.Manager.readOnly) { %>
  <div class="pull-right">
    <button type="button" class="btn btn-default btn-sm remove">Remove</button>
  </div>
  <% } %>
</div>

</script>

<script type="text/template" id="comment-content-template">
<div class="ws-box commentView">
  <div class="comment-close">
    <button type="button" class="closeme close" aria-hidden="true"><i class="fa fa-times"></i></button>
  </div>
  <div class="commentHeader">
    <p class="ws-stream-meta command-context">
      <a class="userLink userLinkPicture" href="<%= userCreated.url %>"><img class="userPicture" src="<%= userCreated.imageUrl %>" width="16" height="16"></a>
      <a href="<%= userCreated.url %>"><%= userCreated.username %></a>
      <% if (smartDate == '__live__') { %>
      <abbr class="timeago" title="<%= (new Date(parseInt(dateCreated, 10) * 1000)).toISOString() %>">
        <%= dateCreated %>
      </abbr>
      <% } else { %>
        <%- smartDate %>
      <% } %>
      <% if (ws.context.user.canAdministerWiki && ws.comments.Manager.readOnly) { %>
        <i class="fa fa-trash-o contextual-command delete ws-tip" title="Delete Comment"></i>
      <% } %>
    </p>
  </div>

  <div class="commentBody">
    <div class="commentContent">
      <%= description %>
    </div>

      <% for(i = 0; i < replyPages.length; i++) { %>
        <% for(var j = 0; j < replyPages[i].digests.length; j++) { %>
      <div class="commentReply" data-id="<%= replyPages[i].digests[j].id %>">
        <p class="ws-stream-meta command-context">
          <a class="userLink userLinkPicture" href="<%= replyPages[i].digests[j].userCreated.url %>"><img class="userPicture" src="<%= replyPages[i].digests[j].userCreated.imageUrl %>" width="16" height="16"></a>
          <a href="<%= replyPages[i].digests[j].userCreated.url %>"><%= replyPages[i].digests[j].userCreated.username %></a>
          <% if (smartDate == '__live__') { %>
          <abbr class="timeago" title="<%= (new Date(parseInt(replyPages[i].digests[j].dateCreated, 10) * 1000)).toISOString() %>">
            <%= new Date(parseInt(replyPages[i].digests[j].dateCreated, 10) * 1000).toLocaleString() %>
          </abbr>
          <% } else { %>
            <%- smartDate %>
          <% } %>
          <% if (ws.context.user.canAdministerWiki) { %>
          <i class="fa fa-trash-o contextual-command delete-reply ws-tip" title="Delete Reply"></i>
          <% } %>
          </p>
        <div class="commentContent"><%= replyPages[i].digests[j].body %></div>
      </div>
        <% } %>
      <% } %>

      <form class="reply commentReply">
        <div class="form-group">
          <textarea name="reply" placeholder="Reply" class="form-control" /></textarea>
        </div>
        <div class="btn-toolbar">
          <button type="submit" class="btn btn-primary btn-sm" name="go" value="1">Post</button>

          <% if (ws.context.user.id) { %>
            <% if (monitored) { %>
            <button type="button" class="btn btn-default btn-sm pull-right toggle-monitor ws-tip active" title="You are monitoring replies."><i class="fa fa-eye"></i></button>
            <% } else { %>
            <button type="button" class="btn btn-default btn-sm pull-right toggle-monitor ws-tip" title="You are not monitoring replies."><i class="fa fa-eye"></i></button>
            <% } %>
          <% } %>
          <% if (ws.context.user.canAdministerWiki) { %>
            <% if (locked) { %>
            <button type="button" class="btn btn-default btn-sm pull-right toggle-lock ws-tip active" title="Replies are not allowed."><i class="fa fa-lock"></i></button>
            <% } else { %>
            <button type="button" class="btn btn-default btn-sm pull-right toggle-lock ws-tip" title="Replies are allowed."><i class="fa fa-lock"></i></button>
            <% } %>
          <% } %>

          <i class="fa fa-spinner fa-spin spinner pull-right hidden"></i>
        </div>
      </form>
   </div>

   
<div class="commentFooter modal-footer">
  <div class="pull-left">
    <button type="button" class="btn btn-default btn-sm previous"><i class="fa fa-arrow-left"></i></button>
    <button type="button" class="btn btn-default btn-sm next"><i class="fa fa-arrow-right"></i></button>
  </div>
  <% if (ws.context.user.canAdministerWiki && !ws.comments.Manager.readOnly) { %>
  <div class="pull-right">
    <button type="button" class="btn btn-default btn-sm remove">Remove</button>
  </div>
  <% } %>
</div>

</div>
</script>

<script type="text/template" id="comment-composer-template">
<div class="ws-box commentView">
  <div class="commentComposer">
    <div class="comment-close">
      &nbsp;<button type="button" class="close closeme" aria-hidden="true"><i class="fa fa-times"></i></button>
    </div>
    <div class="commentHeader">
      <p class="ws-stream-meta command-context">
        <img class="userPicture" src="<%= userCreated.imageUrl %>" width="16" height="16">
        <a href="#" onclick="return false;"><%= userCreated.username %></a>
      </p>
    </div>
    <div class="commentBody">
      <textarea name="comment" class="compose form-control" placeholder="Comment"/></textarea><br/>
      <div class="btn-toolbar">
        <button type="button" class="btn btn-default btn-sm monitored active pull-right" style="margin-left: 6px" onclick="jQuery(this).toggleClass('active')"><i class="fa fa-eye"></i></button>
        <button type="button" class="btn btn-default btn-sm locked btn-toggle pull-right" onclick="jQuery(this).toggleClass('active')"><i class="fa fa-lock"></i></button>
        <button type="button" class="btn btn-primary btn-sm closeme">Save</button>
      </div>
    </div>
  </div>

  
<div class="commentFooter modal-footer">
  <div class="pull-left">
    <button type="button" class="btn btn-default btn-sm previous"><i class="fa fa-arrow-left"></i></button>
    <button type="button" class="btn btn-default btn-sm next"><i class="fa fa-arrow-right"></i></button>
  </div>
  <% if (ws.context.user.canAdministerWiki && !ws.comments.Manager.readOnly) { %>
  <div class="pull-right">
    <button type="button" class="btn btn-default btn-sm remove">Remove</button>
  </div>
  <% } %>
</div>

</div>
</script>

<script type="text/template" id="comment-proxy-template">
<div class="comment-proxy">
  <span class="commentUser">
  <% if (userCreated) { %>
    <img class="userPicture" src="<%= userCreated.imageUrl %>" width="16" height="16">
  <% } else { %>
    <img class="userPicture" src="<%= ws.context.user.imageUrlPrefix %>sm.jpg" width="16" height="16">
  <% } %>
  </span>
  <span class="commentReplies"><%= 1 + _(replyPages).reduce(function(memo, page){ return memo + page.digests.length; }, 0) %></span>
</div>
</script>

<div class="ws-menu-bar WikiControls WikispacesContent WikispacesBs3">
  
    <h1 class="pageTitle"><a href="/Updates">Updates</a></h1>
      <div class="btn-group pull-right">
          <span class="btn btn-default disabled tipme" title="you do not have permission to edit this page"><i class="fa fa-pencil fa-fw"></i> Edit</span>          <a class="btn btn-default tipme" title="no discussion posts" href="/Updates#discussion"><i class="fa fa-comments fa-fw"></i> 0</a>          <a class="btn btn-default tipme" title="view 24 revisions" href="/page/history/Updates"><i class="fa fa-clock-o fa-fw"></i> 24</a>          <a class="btn btn-default ws-btn-more dropdown-toggle tipme" title="more options" href="/page/menu/Updates"><i class="icon-height-only fa-fw"></i>&hellip;</a>        <ul class="ws-more-menu dropdown-menu dropdown-menu-right">
              <li class=" dropdown"><a class=" ws-tag-dropdown-toggle" href="/page/tags/Updates"><span class="pull-right">0</span> <i class="fa fa-tag fa-fw"></i> Tags</a>
          <div class="dropdown-menu dropdown-menu-right ws-tag-dropdown-menu">
          



<form action="#" name="WikiTagForm" class="WikiTagForm"><input type="hidden" name="wikispacesFormToken" value="98578bed4c4e961e2711745132a529833897df6a"/><input type="hidden" name="wikispacesFormToken" value="98578bed4c4e961e2711745132a529833897df6a"/>
  <div class="WikiTagList">
    <i class="fa fa-tag ws-action"></i>
        <ul class="list-unstyled">
          <li>No tags</li>
        </ul>
      </div>
  </form>      </div>
    </li>
              <li class="divider"></li>
            <li class=""><a class=" WikispacesDialogLink" href="https://colour-recovery.github.io/wiki/addmonitor?monitorLink=page%3AUpdates"><i class="fa fa-eye fa-fw"></i> Notify</a>
    </li>
        <li class=""><a class=" WikispacesDialogLink" href="/page/rss/Updates"><i class="fa fa-rss fa-fw"></i> RSS</a>
    </li>
        <li class=""><a class="" href="/page/links/Updates"><i class="fa fa-link fa-fw"></i> Backlinks</a>
    </li>
              <li class="divider"></li>
            <li class=""><a class="" href="/page/code/Updates"><i class="fa fa-code fa-fw"></i> Source</a>
    </li>
        <li class=""><a class="" href="/Updates?f=print"><i class="fa fa-print fa-fw"></i> Print</a>
    </li>
        <li class=""><a class="" href="/page/pdf/Updates"><i class="fa fa-cloud-download fa-fw"></i> Export (PDF)</a>
    </li>
      </ul>  </div>
  </div>




  <textarea class="form-control" id="autosaveContent" style="display:none;" rows="1" cols="1"></textarea>
  <div id="autosavePrompt" style="display:none;"></div>

<div class="commentContainer">
  <div class="commentSubject">
  <div class="wiki wikiPage" id="content_view">
  <strong><u>6th March 2010</u></strong><br />
<br />
Have finally got round to writing this update detailing recent work!<br />
<br />
<br />
<u><strong>New Software</strong></u><br />
<br />
First I have improved my QBASIC programs, and the new versions are provided here:<br />
<!-- ws:start:WikiTextFileRule:9:&lt;img src=&quot;../www.wikispaces.com/site/embedthumbnail/file/Undist1j.bas?h=52&amp;w=320&quot; class=&quot;WikiFile&quot; id=&quot;wikitext@@file@@Undist1j.bas&quot; title=&quot;File: Undist1j.bas&quot; width=&quot;320&quot; height=&quot;52&quot; /&gt; --><div class="objectEmbed"><a href="/file/view/Undist1j.bas/125464243/Undist1j.bas" onclick="ws.common.trackFileLink('/file/view/Undist1j.bas/125464243/Undist1j.bas');"><img src="../ssl.wikicdn.com/i/mime/32/text/plain.png" height="32" width="32" alt="Undist1j.bas" /></a><div><a href="/file/view/Undist1j.bas/125464243/Undist1j.bas" onclick="ws.common.trackFileLink('/file/view/Undist1j.bas/125464243/Undist1j.bas');" class="filename" title="Undist1j.bas">Undist1j.bas</a><br /><ul><li><a href="/file/detail/Undist1j.bas">Details</a></li><li><a href="/file/view/Undist1j.bas/125464243/Undist1j.bas">Download</a></li><li style="color: #666">8 KB</li></ul></div></div><!-- ws:end:WikiTextFileRule:9 --><!-- ws:start:WikiTextFileRule:10:&lt;img src=&quot;../www.wikispaces.com/site/embedthumbnail/file/Undist2c.bas?h=52&amp;w=320&quot; class=&quot;WikiFile&quot; id=&quot;wikitext@@file@@Undist2c.bas&quot; title=&quot;File: Undist2c.bas&quot; width=&quot;320&quot; height=&quot;52&quot; /&gt; --><div class="objectEmbed"><a href="/file/view/Undist2c.bas/125464289/Undist2c.bas" onclick="ws.common.trackFileLink('/file/view/Undist2c.bas/125464289/Undist2c.bas');"><img src="../ssl.wikicdn.com/i/mime/32/text/plain.png" height="32" width="32" alt="Undist2c.bas" /></a><div><a href="/file/view/Undist2c.bas/125464289/Undist2c.bas" onclick="ws.common.trackFileLink('/file/view/Undist2c.bas/125464289/Undist2c.bas');" class="filename" title="Undist2c.bas">Undist2c.bas</a><br /><ul><li><a href="/file/detail/Undist2c.bas">Details</a></li><li><a href="/file/view/Undist2c.bas/125464289/Undist2c.bas">Download</a></li><li style="color: #666">8 KB</li></ul></div></div><!-- ws:end:WikiTextFileRule:10 --><br />
These include bug fixes and I've also introduced some running average filtering for the horizontal distortion values.<br />
<br />
I also attempted to create a single-pass process in order to do away with Undist2, and that version is presented here:<br />
<!-- ws:start:WikiTextFileRule:11:&lt;img src=&quot;../www.wikispaces.com/site/embedthumbnail/file/Undist1i.bas?h=52&amp;w=320&quot; class=&quot;WikiFile&quot; id=&quot;wikitext@@file@@Undist1i.bas&quot; title=&quot;File: Undist1i.bas&quot; width=&quot;320&quot; height=&quot;52&quot; /&gt; --><div class="objectEmbed"><a href="/file/view/Undist1i.bas/125558835/Undist1i.bas" onclick="ws.common.trackFileLink('/file/view/Undist1i.bas/125558835/Undist1i.bas');"><img src="../ssl.wikicdn.com/i/mime/32/text/plain.png" height="32" width="32" alt="Undist1i.bas" /></a><div><a href="/file/view/Undist1i.bas/125558835/Undist1i.bas" onclick="ws.common.trackFileLink('/file/view/Undist1i.bas/125558835/Undist1i.bas');" class="filename" title="Undist1i.bas">Undist1i.bas</a><br /><ul><li><a href="/file/detail/Undist1i.bas">Details</a></li><li><a href="/file/view/Undist1i.bas/125558835/Undist1i.bas">Download</a></li><li style="color: #666">7 KB</li></ul></div></div><!-- ws:end:WikiTextFileRule:11 --><br />
The double-pass process is only necessary because I've been unable to find an equation that precisely reverses the pre-distortion factor in the initial references. Instead I've reversed it approximately with Undist1, and then used Undist2 to tweak it for full correction.<br />
The following lines of code in Undist1i were designed to get over this problem, and compensate for the pre-distortion precisely:<br />
<br />
z = (16 * VAL(csv$(1))) + VAL(csv$(3)) - 960<br />
v = z - .677157215# + (.00627464474# * z) + (.00000547508015# * (z ^ 2)) - (.0000000472352485# * (z ^ 3))<br />
x1(x) = z + 960 + .677157215# - (.00627464474# * v) - (.00000547508015# * (v ^ 2)) + (.0000000472352485# * (v ^ 3))<br />
<br />
These are based on the maths of reference frame transformation, and should work perfectly; but for some reason they completely fail.<br />
Perhaps someone cleverer than me can solve this problem!<br />
<br />
<br />
<u><strong>Matching Film Recordings to existing domestic VT Recordings</strong></u><br />
<br />
I'm fairly confident that my macro for matching the footage frame-by-frame will work well, and within acceptable processing times.<br />
I have yet to test this, and am currently waiting for a suitable VT image sequence.<br />
If it works it should prove particularly useful for the &quot;Dr. Who&quot; story &quot;Ambassadors Of Death&quot;, since the VT copy has large sections of unusable chroma. Matching the film recording to the VT geometry should hopefully give a much better chance of colour recovery with minimal quadrant errors.<br />
<br />
Problems may arise around the edges of the frame, since the film recording is cropped relative to the VT. It should only be a concern if there are regions at the edge of frame with no luminance detail for ImageJ to lock onto.<br />
<br />
I suspect the processing times on a modern computer would be much faster than I've previously reported.<br />
My computer has a single-core 2GHz CPU, with PC2100 memory, and IDE (UDMA Mode 5) hard-drives.<br />
All these components are now obsolete, and slow down my processing times considerably.<br />
<br />
After processing, I can recombine the output image sequence into a Y8 video file using the following AviSynth script processed through Virtual Dub:<br />
<br />
c = ImageSource(&quot;F:\Output\%01d.bmp&quot;, start = 0, end = 1024)<br />
ImmaWrite(c, &quot;output filename.y&quot;, type=&quot;raw&quot;, mode=&quot;Grayscale&quot;, animation=true)<br />
<br />
(This requires that the Immaavs set of dll's is first installed into the system path.)<br />
<br />
The Y8 file can then be processed through the CR software.<br />
<br />
(There are some annoying quirks of bUnwarpJ when it comes to the output image formats produced. This means I sometimes have to run a batch conversion on the output image sequence, before I can recombine them into a Y8 video. But I won't bore you with the details!)<br />
<br />
<br />
<u><strong>Field Separation tests</strong></u><br />
<br />
I had hoped my field separations would eliminate CR quadrant assignment errors where the two fields are different, and possibly allow restoration of 50Hz motion.<br />
However I've found that the amount of separation I've accomplished is too small to achieve either of these goals.<br />
It's still possible that a higher resolution film scan could allow more separation; but I fear my discovery that some field separation is possible may remain of intellectual interest only, and have little practical use.<br />
<br />
<br />
<u><strong>Problems with my undistort process</strong></u><br />
<br />
I realised some time ago that my version of Custom Reference does not work. This is because ImageJ can only work on image files; but the reference files are binaries containing both positive and negative values. When I convert them to images, the negative values become positive, and so the structure of the files is lost.<br />
This could perhaps be solved by transforming and rescaling the values so they're all positive before converting to image format, then applying the custom distortion with ImageJ, and then reversing the earlier transform to reintroduce negative values.<br />
However I don't plan to spend anymore time on this, since it's essentially duplicating Richard's work (the only difference is that my custom references would be more accurate, being based on the B-Spline model, and they would not suffer from Runge's phenomenon).<br />
<br />
I have also found that my undistort method, using the above QBASIC programs, does not work well with poorer quality film recordings, and can produce some very distorted output frames.<br />
This is because these film recordings tend to have large regions of missing geometry data, which are impossible to interpolate correctly intra-frame.<br />
These regions tend to appear monochrome following CR; though it in fact produces a faint pattern of multi-coloured noise. My guess is that the chroma was less saturated in these areas, and the chroma patterning is only weakly imprinted on the film.<br />
<br />
I attempted to get round this problem by filling in the missing geometry data from a frame elsewhere in the footage where the data is complete. However this doesn't work because the transient changes in horizontal distortion are too large: so you end up with unacceptable picture skews.<br />
<br />
The poorer film recordings also have multiple quadrant assignment errors in every single frame.<br />
Suprisingly I have discovered that my undistort process can actually iron-out some of these errors so they no longer appear when CR is applied to the undistorted frame. The number of errors is reduced as a result; but errors are by no means completely eliminated.<br />
When deriving the undistort transform from the best frame I could find (call this Frame A), and applying it to the whole of the footage, I found that there were fewer quadrant errors, and a lot less manual intervention required in terms of &quot;quadrant prompts&quot;.<br />
However it also imprinted some of the quadrant errors from Frame A throughout the footage!<br />
I suspect my results were no better than Richard can achieve with his Custom Reference method, and most likely worse because of the imprinting effect.<br />
<br />
<br />
<strong><u>Universal Reference</u></strong><br />
<br />
I was asked to try and find a Universal Reference, instead of deriving Custom References for each scene.<br />
Whilst this may well work for the y-distortion; I have found that it's not possible for the x-distortion since the variations in geometry are too extreme.<br />
<br />
The horizontal distortion images below illustrate the problem:<br />
<!-- ws:start:WikiTextLocalImageRule:0:&lt;img src=&quot;/file/view/771.jpg/125570471/771.jpg&quot; alt=&quot;&quot; title=&quot;&quot; /&gt; --><img src="/file/view/771.jpg/125570471/771.jpg" alt="771.jpg" title="771.jpg" /><!-- ws:end:WikiTextLocalImageRule:0 --><br />
<!-- ws:start:WikiTextLocalImageRule:1:&lt;img src=&quot;/file/view/1024.jpg/125570473/1024.jpg&quot; alt=&quot;&quot; title=&quot;&quot; /&gt; --><img src="/file/view/1024.jpg/125570473/1024.jpg" alt="1024.jpg" title="1024.jpg" /><!-- ws:end:WikiTextLocalImageRule:1 --><br />
<!-- ws:start:WikiTextLocalImageRule:2:&lt;img src=&quot;/file/view/63.jpg/125570467/63.jpg&quot; alt=&quot;&quot; title=&quot;&quot; /&gt; --><img src="/file/view/63.jpg/125570467/63.jpg" alt="63.jpg" title="63.jpg" /><!-- ws:end:WikiTextLocalImageRule:2 --><br />
<!-- ws:start:WikiTextLocalImageRule:3:&lt;img src=&quot;/file/view/118.jpg/125570469/118.jpg&quot; alt=&quot;&quot; title=&quot;&quot; /&gt; --><img src="/file/view/118.jpg/125570469/118.jpg" alt="118.jpg" title="118.jpg" /><!-- ws:end:WikiTextLocalImageRule:3 --><br />
<br />
The first two images are from the same scene with a locked-off camera shot. There's an actor in the foreground who is moving to the right.<br />
You can see how much data is missing, and how difficult it would be to interpolate.<br />
Notice how much the form of the distortion has changed over a very short period of time. Indeed it often changes rapidly from one frame to the next, especially when you have an object moving in the foreground.<br />
I imagine this must limit the usefulness of Richard's Custom Reference method.<br />
<br />
The second two images are taken from another locked off camera-shot, with several actors moving in the middle-distance on the rhs of frame.<br />
Note how much the distortion changes even on the left of frame where there is no movement!<br />
<br />
Now if we could find a model that would predict these changes in distortion, it would be extremely useful, as we could use this model to derive a unique undistort transform for every frame. Once processed the footage would be distortion free, and thus CR could be carried out with no quadrant errors (except where there are different colours in each field superimposed at the same point).<br />
Unfortunately finding such a model is an extremely difficult task.<br />
If I were to attempt it, I would first try to find a correlation between picture content and distortion as follows:<br />
<br />
Find two test frames with a good spread of colour across them, so we can get reliable geometry data.<br />
Then interpolate any missing geometry data (Undist1 and 2 already do this, producing a file called mod.csv containing a complete set of values).<br />
<br />
We ignore the y-displacement, since this is fairly consistent throughout the footage.<br />
<br />
We then have the following scalar fields:<br />
For each quadrant block:<br />
D1(x,y) = x-displacement of test frame 1 (in HD pixels)<br />
D2(x,y) = x-displacement of test frame 2 (in HD pixels)<br />
L1(x,y) = luminance of test frame 1 (averaged over each quadrant block)<br />
L2(x,y) = luminance of test frame 2 (averaged over each quadrant block)<br />
f(x,y) = scalar field of weighting constants (since the influence of luma on the distortion may well vary depending on the coordinates)<br />
<br />
My hunch is that the distortion will be proportional to the square of the luma, which would give the following equation:<br />
D2(x,y) - D1(x,y) = f(x,y)(L2(x,y)^2 - L1(x,y)^2)<br />
<br />
Using our test frame data we can solve for f(x,y), and hence we would have an equation to predict the x-distortion in every frames for that particular piece of footage.<br />
(To be more rigorous, we should really take multiple test frames and fit the data to a generalised polynomial series in L1 and L2, but then it starts to get really complicated!)<br />
<br />
However this formula is not good enough!<br />
We can see from the second pair of images above that the distortion changes radically on the lhs, even though the luma remains constant in that area.<br />
I suspect this is because the change in luma on the rhs of frame is affecting the distortion on the lhs!<br />
So we would need to reflect this symmetry in our equation, perhaps as follows:<br />
<br />
L1r(x,y) = luminance of test frame 1 reflected around the vertical centre-line of the distortion pattern<br />
L2r(x,y) = luminance of test frame 2 reflected around the vertical centre-line of the distortion pattern<br />
<br />
Our equation then becomes:<br />
D2(x,y) - D1(x,y) = f(x,y)(L2(x,y)^2 - L1(x,y)^2) + g(x,y)(L2r(x,y)^2 - L1r(x,y)^2)<br />
where g(x,y) is a second set of weighting constants.<br />
<br />
To solve for both f(x,y) and g(x,y) we would need simultaneous equations, so we would have to use at least three test frames.<br />
You can see how impossibly complicated it becomes!!<br />
<br />
The make things still worse, here is a horizontal distortion image from a different film recording:<br />
<!-- ws:start:WikiTextLocalImageRule:4:&lt;img src=&quot;/file/view/totp_ch08.jpg/125570475/totp_ch08.jpg&quot; alt=&quot;&quot; title=&quot;&quot; /&gt; --><img src="/file/view/totp_ch08.jpg/125570475/totp_ch08.jpg" alt="totp_ch08.jpg" title="totp_ch08.jpg" /><!-- ws:end:WikiTextLocalImageRule:4 --><br />
This one is not symmetrical about the centre-line; but rather around a diagonal line drawn from bottom left to top right.<br />
This arises because the y-displacements are more diagonally orientated for this particular film recording.<br />
<br />
I have concluded that I'm not clever enough to develop a suitable model, even if I had the time (which I don't!)<br />
Perhaps someone else would like to take up the challenge. (As a first step I would try removing the vertical distortion only, and see if I could spot any obvious pattern in the horizontal distortion.)<br />
<br />
The thought occurs that someone with an expertise in CRT design would probably find this quite easy to solve.<br />
When designing a tube, you would presumably have a formula for the electric field E(x,y,z,t,i), and use it to calculate the beam deflections to assess how the linearity performs. (N.B. i = the beam current.)<br />
In this case we have the opposite situation: we know what the beam deflections are in our test frame, and we need to deduce a formula for the electric field. This could then be used to calculate beam deflections for all subsequent frames.<br />
The time evolution of the field depends on the waveforms of the driving voltages for the field coils, which in turn depend on the way that particular film recorder has been adjusted by it's various rheostats. The beam current would also affect the field pattern, because the electron beam itself has a field, and the amount of current drawn by the beam probably affects the power supply to the field coils.<br />
<br />
<br />
<u><strong>17th April 2010</strong></u><br />
<br />
I have now conducted an experiment with my frame-by-frame matching process, using an FR and corresponding domestic VT.<br />
As usual it was harder than I expected it to be!<br />
<br />
<br />
<strong><u>Cropping problem</u></strong><br />
<br />
The initial results were very poor, and I quickly discovered that the variable cropping was confusing the pattern-matching process.<br />
So I masked off the head-switching area of the VT, as well as a small slither at the top of frame.<br />
I also masked off the right-hand-side of the FR, since (surprisingly) it contained more active picture content than the VT in that region.<br />
(I achived this using multiple instances of the &quot;fill&quot; filter in Virtual Dub.)<br />
<br />
This solved the problem, and the pattern-matching began to work well.<br />
<br />
<br />
<u><strong>Input format</strong></u><br />
<br />
The next problem to solve was choosing a suitable format for the image sequences.<br />
I began by using 8-bit bmp's; but this produced an unexplained rapid fluctuation in the black levels on the output sequence.<br />
So I then switched to 24-bit bmp's, which resolved the issue; but led to a glacial 3.3 minutes per frame processing speed!<br />
<br />
Next I tried 8-bit tif's, which reduced the processing time to a more acceptable 1.25 minutes per frame.<br />
However the output tif's were about 11 times larger than the inpit tif's, and could only be opened in ImageJ (other image viewers didn't recognise them). Therefore I had to run ImageJ's batch conversion macro and convert them back to bmp format, before I could recombine them into a raw video-stream.<br />
<br />
Since this is not very convenient I tried using 8-bit png format for the image sequences, and this worked perfectly, producing 8-bit output png's that can be directly combined into a raw video-stream. Processing times were circa 1.25 - 1.5 minutes per frame depending on the processing settings used.<br />
<br />
<br />
<strong><u>Effect on CR</u></strong><br />
<br />
As a control for my experiment I created a simple undistorted version of the FR, based on the chroma of one test frame (similar to Richard's undistort solution).<br />
I then performed CR on the raw FR, the simple undistort of the FR, and the frame-by-frame undistorted version.<br />
Since the idea of frame-by-frame processing is to reduce the amount of manual intervention required, I unchecked the &quot;Quadrant Prompt&quot; option in all cases.<br />
<br />
Scene 2 of the footage was particularly problematic for the CR process. The raw footage failed completely to get the right quadrants. The simple undistort produced some improvement; but I was pleased to discover that the frame-by-frame process produced by far the best result. Nearly all the quadrants were correctly selected without any manual intervention.<br />
<br />
Scene 3 was a different matter, and on this I found the frame-by-frame undistort introduced new errors, with the simple undistort giving the best results. The problem was an area of low texture immediately behind a moving actor close-up in the foreground. As he moved across the frame, he dragged the geometry of the low-texure area with him. The pattern-matching failed because there was no detail for it to lock onto in this low texture area.<br />
<br />
So it may turn out my frame-by-frame process is only useful for improving CR in certain problem scenes.<br />
<br />
<br />
<strong><u>Geometric differences between the domestic VT and the original broadcast VT</u></strong><br />
<br />
These differences turned out to be more pronounced than I expected, especially in the horizontal direction.<br />
The line-blanking interval on the domestic VT appeared to have been increased and was eating into the active picture content on the right-hand-side of frame. I assume this may have been the result of the PAL-NTSC-PAL conversions?<br />
There was also some horizontal compression of the line timing, and possibly some wow-and-flutter variations from the VT scanner.<br />
<br />
To match the original broadcast VT geometry an additional 2nd-pass transformation would be needed.<br />
This may possibly make the footage more CR-friendly still.<br />
I could generate this transform from the chroma; but unfortunately the frame-by-frame pattern-matching produces variations in areas of low texture around the edges of frame, so the 2nd-pass transformation needed would not remain constant across the footage.<br />
<br />
Here is an example of the horizontal and vertical distortion remaining after the frame-by-frame processing:<br />
<!-- ws:start:WikiTextLocalImageRule:5:&lt;img src=&quot;/file/view/262_%28H%29.jpg/135035027/262_%28H%29.jpg&quot; alt=&quot;Horiz distortion&quot; title=&quot;Horiz distortion&quot; /&gt; --><table class="captionBox"><tr><td class="captionedImage"><img src="/file/view/262_%28H%29.jpg/135035027/262_%28H%29.jpg" alt="262_(H).jpg" title="262_(H).jpg" /></td></tr><tr><td class="imageCaption">Horiz distortion</td></tr></table><!-- ws:end:WikiTextLocalImageRule:5 --><br />
<!-- ws:start:WikiTextLocalImageRule:6:&lt;img src=&quot;/file/view/262_%28V%29.jpg/135035023/262_%28V%29.jpg&quot; alt=&quot;Vert distortion&quot; title=&quot;Vert distortion&quot; /&gt; --><table class="captionBox"><tr><td class="captionedImage"><img src="/file/view/262_%28V%29.jpg/135035023/262_%28V%29.jpg" alt="262_(V).jpg" title="262_(V).jpg" /></td></tr><tr><td class="imageCaption">Vert distortion</td></tr></table><!-- ws:end:WikiTextLocalImageRule:6 --><br />
<br />
<br />
<u><strong>Geometric fluctuations</strong></u><br />
<br />
Unfortunately a side-effect of my frame-by-frame process, is an undesirable rapid fluctuation in geometry on low texture areas, and around the edges of the frame.<br />
<br />
The test sequence I'm using is particularly problematic, since it originated from location footage.<br />
This makes it particularly prone to bounce and weave, due to the following sources:<br />
1) The film camera used on location.<br />
2) The original 1970's telecine playout of the location footage.<br />
3) The film camera used in the film recording.<br />
4) The more recent HD telecine transfer (though this should be more stable with modern equipment).<br />
<br />
All these sources of positional instability produce a rapid flexing of the geometry that would be disturbing for the viewer.<br />
<br />
There are three possible solutions:<br />
1) Deform the domestic VT frame-by-frame to match the FR. This would be useless for CR; but could be useful when using the VT to overlay colour onto the FR. Changes in the geometry of the chroma in untextured areas would not be very noticeable to the viewer. (This would require processing in 24 bit RGB, which would be slow.)<br />
<br />
2) Apply film stabilisation to both the VT and FR prior to processing. This would most likely have a negative effect on CR, but this wouldn't matter if you just wanted to do VT colour overlay.<br />
<br />
3) Constrain the div and curl derivatives of the undistort vector field. (These measure the amount of divergence and curvature in the field respectively.)<br />
<br />
I've experimented with this last method, and found that applying the maximum constraints produces a big improvement in geometric stability; but has a very negative effect on CR.<br />
Am currently trying to find the best compromise settings, to get both good stability and good CR.<br />
<br />
<br />
This field sequence of this particular test footage was out-of-phase; but this appears to have had little impact on the pattern-recognition process, which was still able to get a good cross-match between the FR and VT frames.<br />
<br />
<br />
The Undistort Macro I ended up with after all these changes, was the following:<br />
<br />
dirf = getDirectory(&quot;Choose FR directory &quot;);<br />
dirv = getDirectory(&quot;Choose VT directory &quot;);<br />
diro = getDirectory(&quot;Choose output directory &quot;);<br />
for (i = 10; i &lt; 1025; i++)<br />
{<br />
j = i + 49;<br />
open(dirv+i+&quot;.png&quot;);<br />
open(dirf+j+&quot;.png&quot;);<br />
run(&quot;bUnwarpJ&quot;, &quot;registration=Mono image_subsample_factor=0 initial_deformation=[Very Coarse] final_deformation=[Fine] divergence_weight=1 curl_weight=1 landmark_weight=0 image_weight=1 stop_threshold=0.01&quot;);<br />
save(diro+i+&quot;.png&quot;);<br />
close();<br />
close();<br />
close();<br />
}<br />
<br />
N.B. The line j = i + 49 is required because there is a 49 frame offset in the numbering used for the FR and VT sequences.<br />
<br />
<br />
<u><strong>Applications of vector and scalar field constraints in CR</strong></u><br />
<br />
The biggest remaining problem with CR is to get rid of the quadrant errors when there is motion that results in differences between the fields.<br />
I've noticed these usually arise not from two different colours overlapping and mixing between the fields; but rather the disturbance in vertical and horizontal displacement values caused by the phase rotation of the vertical measurement.<br />
It may be possible to filter the displacement values to remove these disturbances.<br />
<br />
Since the distortion in the FR is represented by a 2D vector field, the most natural way to filter the displacement values for errors is to apply constraints that can act on the vectors directly.<br />
So it may well turn out that constraining the div and curl of the vector field prior to generating a quadrant map, will reduce the number of quadrant errors.<br />
<br />
Since curl is itself a vector field, you would probably want to constrain the magnitude of the curl vectors.<br />
The div however, is a scalar field, and therefore you can constrain it directly.<br />
<br />
Previously I've tried filtering the displacement values by calculating a running-average; but since that's a 1D filter it's less likely to be effective.<br />
<br />
<br />
Another possibility is to try filtering in the frequency domain.<br />
I've noticed that lots of ripples appear in the vector field during panning shots (caused by the phase disturbances in the vertical measurement). By splitting the vector field into horizontal and vertical scalar fields, and applying FFT's, it may be possible to remove this ripple using 2D frequency domain filtering.<br />
Alternatively you could constrain the partial derivatives of the scalar fields.<br />
<br />
Here is an example of the ripple introduced when the fields are different.<br />
The first image shows the vertical displacement maps for the locked-off shot immediately before the camera pans, and the next image shows what happens after the camera starts to pan:<br />
<!-- ws:start:WikiTextLocalImageRule:7:&lt;img src=&quot;/file/view/Ripple_V_1.jpg/135035057/Ripple_V_1.jpg&quot; alt=&quot;&quot; title=&quot;&quot; /&gt; --><img src="/file/view/Ripple_V_1.jpg/135035057/Ripple_V_1.jpg" alt="Ripple_V_1.jpg" title="Ripple_V_1.jpg" /><!-- ws:end:WikiTextLocalImageRule:7 --><br />
<!-- ws:start:WikiTextLocalImageRule:8:&lt;img src=&quot;/file/view/Ripple_V_2.jpg/135035055/Ripple_V_2.jpg&quot; alt=&quot;&quot; title=&quot;&quot; /&gt; --><img src="/file/view/Ripple_V_2.jpg/135035055/Ripple_V_2.jpg" alt="Ripple_V_2.jpg" title="Ripple_V_2.jpg" /><!-- ws:end:WikiTextLocalImageRule:8 --><br />
<br />
<br />
<u><strong>2nd July 2010</strong></u><br />
<br />
Discovered a problem with the png input format: it seems to be producing the same black level fluctuations I've seen previously with other input formats. So I've had to go back to using tiff sequences for 8-bit processing.<br />
<br />
<br />
<strong><u>Conforming the VT to the FR</u></strong><br />
<br />
Today I concluded my experiment to match a domestic colour VT to the corresponding FR in a frame-by-frame process.<br />
I had assumed this would slow down processing because it requires 24-bit image sequences (obviously!); but then I realised there was no reason to process in 1080X1920, since 576X720 is perfectly adequate.<br />
With this lower resolution, processing times are speeded up to around 36 seconds per frame on my PC (at least 4 times faster on a more up to date PC).<br />
(N.B. An added benefit to 24-bit processing is that there are no input format issues.)<br />
<br />
Initially ImageJ produced quite a lot of errors in the geometry of the output frames, with some very odd distortions appearing!<br />
I solved this by adjusting the div and curl constraints to maximum, which fully resolved the issue.<br />
<br />
I combined the colour output sequence with the original FR using the following AviSynth script:<br />
<br />
ImageSource(&quot;F:\FR (SD)(24 bit)(mask 2)\%d.bmp&quot;, 3, 722)<br />
lumavid = ConvertToYV12()<br />
ImageSource(&quot;F:\Output\%d.bmp&quot;, 3, 722)<br />
chromavid = ConvertToYV12()<br />
MergeChroma(lumavid, chromavid)<br />
<br />
I'm pleased to say the geometry seemed to line up very well indeed, and I was very happy with the end result.<br />
I noticed some minor colour-bleed; but this was already present on the original domestic VT.<br />
There are also some intermittent problems on the extreme right and left margins of frame, where the colour twitches in and out of alignment. These would probably have to be trimmed off as they're an unavoidable consequence of the pattern-matching process.<br />
<br />
<br />
<strong><u>Conforming the FR to the VT</u></strong><br />
<br />
I've not had time to make any further progress tweaking the div and curl settings, in order to achieve a more consistent improvement in CR.<br />
I intend to investigate this further when time allows.
  </div>

<div id="pageEditor" class="editorWrapper editorLayer">
  <iframe id="target_editor" name="target_editor" src="/s/blank.html" style="width:0px;height:0px;border:0"></iframe>
    <form action="/page/edit/Updates" method="post" class="editorForm" id="editorForm"><input type="hidden" name="wikispacesFormToken" value="44bc3bcf081ac4af99fa2e0b4c0fd4190115f712"/><div class="wsh"><input type="text" class="form-control" name="wikispaces_user_id" value="user-1528198261"/></div><div class="wsh"><input type="text" class="form-control" name="goto" autocomplete = "off"/></div><div class="movkp"><input type="text" class="form-control" name="mode" autocomplete = "off"/></div><div class="jovise"><input type="text" class="form-control" name="version" autocomplete = "off"/></div><div class="movkp"><input type="text" class="form-control" name="pageComments" autocomplete = "off"/></div><div class="wsh"><input type="text" class="form-control" name="saveAndContinue" autocomplete = "off"/></div><div class="movkp"><input type="text" class="form-control" name="comment" autocomplete = "off"/></div><div class="jovise"><input type="text" class="form-control" name="commentsDisabled" autocomplete = "off"/></div><div class="movkp"><input type="text" class="form-control" name="contentPresent" autocomplete = "off"/></div><div class="wsh"><input type="text" class="form-control" name="editorCleanup" autocomplete = "off"/></div><div class="jovise"><input type="text" class="form-control" name="WikispacesEditorContent" autocomplete = "off"/></div><input type="hidden" name="wikispacesASFormToken" value="c6e357a2e9e26ea2418770088e98e35c16d1fc09"/>
    <input type="hidden" title="goto" name="841a05b55b76b7800c71ff3b8f2bd9106bdf3151" value=""/>
    <input type="hidden" title="mode" name="ade600ddc135fc2c6183b369e6468abda7b653da" autocomplete="off" value="visual"/>
    <input type="hidden" title="version" name="9bd44dfa3b97ea2f7a2625fe1bc03b3eedb17b2f" autocomplete="off" value="151532243"/>
    <input type="hidden" title="pageComments" name="10afafd5dc94747a5999b3f58d5e512b0e6ded4e" autocomplete="off" value=""/>
    <input type="hidden" title="saveAndContinue" name="a20603cc83420e09c90b5a3e13449fe5b91fc706" value="0"/>
    <input type="hidden" title="comment" name="7db592c53ee8367eab10304840e7401a67171c04" value=""/>
    <input type="hidden" title="commentsDisabled" name="f3dd5290b54a4cca2301fd55d15011f65754671a" autocomplete="off" value=""/>
    <input type="hidden" title="contentPresent" name="ff0df34fe77c367f56d4aa631556514c4eea3fe8" autocomplete="off" value=""/>
    <input type="hidden" title="editorCleanup" name="34c148fb8729c1d17634233ca91b339d34077600" autocomplete="off" value=""/>

    <textarea id="wsMainEditor" title="content" class="noContentHide" name="823141862192879e22913b78538ee8a0afdc5c39" style="width: 100%; position: absolute; top: -50000px; left: -50000px;" autocomplete="off"></textarea>

  <noscript>
    <h2>Javascript Required</h2>
    <p>You need to enable Javascript in your browser to edit pages.</p>
  </noscript>

  </form>
  
  
  <div id="plainTextEditor" style="position:relative;display:none" class="editorLayer" >
    <textarea id="textEditor" class="autogrow"></textarea>
    <p style="clear:both;" align="right"><a href="http://helpcenter.wikispaces.com/customer/portal/articles/1959131-wikitext">help on how to format text</a></p>
  </div>
</div>




  </div>
  <div class="commentColumn WikispacesStream"><div class="WikispacesContent WikispacesBs3"><div class="commentList"></div></div></div>
</div>

  




<script type="text/template" id="js-event-template">
  <small>
    <%- startDateShortFormat %>
    <a href="<%- ws.common.pathFor('event', 'view', id) %>" class="WikispacesDialogLink">
      <%- ws.common.truncate(title, 15) %>
    </a>
  </small>
</script>

<script type="text/template" id="js-reply-template">
  <div class="tc-timeline-comment media">

    <a class="pull-left userLink" href="<%- userCreated.url %>">
      <img src="<%- userCreated.imageUrl %>" width="30" height="30" class="author-avatar" alt="" />
    </a>
    <div class="media-body" data-id="<%= id %>">
      <% if (ws.context.user.canAdministerWiki) { %>
        <i class="tc-delete-comment fa fa-trash-o contextual-command destroy-message ws-tip" title="Delete reply"></i>
      <% } %>
      <div class="tc-box-name-date">
        <span class="tc-commenter"><a href="<%- userCreated.url %>"><%- userCreated.username %></a></span>
        <% if (smartDate == '__live__') { %>
        <abbr style="border-bottom-style: none;" class="timeago tc-comment-date" title="<%- (new Date(parseInt(dateCreated) * 1000)).toISOString() %>">
          <%- (new Date(parseInt(dateCreated) * 1000)).toDateString() %>
        </abbr>
        <% } else { %>
          <abbr style="border-bottom-style: none;" class="tc-comment-date"><%- smartDate %></abbr>
        <% } %>
      </div>
      <% if (body) { %>
      <p>
        <%= body %>
      </p>
      <% } %>
    </div>
  </div>
</script>

<script type="text/template" id="js-share-template">
  <div class="tc-timeline-block tc-<%= ws.stream.typeToBlockType(sharedType) %>-block" <%= (ws.stream.hideTimeline ? 'style="padding-left: 0px;"' : '') %>>

    <% if (!ws.stream.hideTimeline) { %>
      <div class="tc-timeline-icon">
        <i class="fa fa-<%= ws.stream.typeToIcon(sharedType) %>"></i>
      </div>
      <div class="tc-timeline-triangle-man"></div>
    <% } %>

    <div class="tc-timeline-box" data-id="<%= id %>">
      <div class="media">
        <a class="pull-left userLink" href="<%- userCreated.url %>">
          <img src="<%- userCreated.imageUrl %>" width="48" height="48" class="author-avatar media-object" alt="" />
        </a>

        <div class="media-body">

          <div class="tc-stream-dropdown">
            <a class="dropdown-toggle" data-toggle="dropdown" href="#">
              <i class="fa fa-chevron-down"></i>
            </a>
            <ul class="dropdown-menu dropdown-menu-right" role="menu">
              <% if (ws.context.user.id) { %>
              <li>
                <a class="js-toggle-monitor" tabindex="-1" href="#">
                  <i class="fa-fw fa fa-eye"></i>
                  <span><%= monitored ? 'Start Monitoring' : 'Stop Monitoring' %></span>
                </a>
              </li>
              <% } %>

              <% if (ws.context.user.canAdministerWiki) { %>
              <li>
                <a class="js-toggle-lock" tabindex="-1" href="#">
                  <i class="fa-fw fa fa-lock"></i>
                  <span><%= locked ? 'Unlock Replies' : 'Lock Replies' %></span>
                </a>
              </li>
              <% if (sharedType == 'discussion' || sharedType == 'comment' || sharedType == 'event') { %>
              <li>
                <a class="js-destroy-share" tabindex="-1" href="#">
                  <i class="fa-fw fa fa-trash-o"></i>
                  Delete <%= ws.stream.typeToName(sharedType) %>
                </a>
              </li>
              <% } %>
              <% } %>
            </ul>
          </div>

          <div class="tc-timeline-box-header ws-reveal media-heading">
              <h3 class="tc-box-title">
              <% if (typeof adminLink !== 'undefined' && adminLink && ws.context.user.canAdministerWiki) { %>
                <a href="<%- adminLink %>"><%- title %></a>
              <% } else { %>
                <%- title %>
              <% } %>
              <% if (typeof startDate !== 'undefined' && startDate) { %> - <%= startDateShortFormat %> <%= ws.stream.getYearFromStartDate(startDate) %><% } %>
              </h3>
              <div class="tc-box-name-date">
                <% if (ws.context.instance.isTesClassroom) { %>
                  <%- userCreated.username %>
                <% } else { %>
                  <a class="author-name" href="<%- userCreated.url %>"><%- userCreated.username %></a>
                <% } %>
                <% if (typeof recipients !== 'undefined' && recipients) { %>
                  <i class="fa fa-angle-right"></i>
                  <% if (typeof recipientsLink !== 'undefined') { %>
                    <a href="<%- recipientsLink %>"><%- recipients %></a>
                  <% } else { %>
                    <span class="recipients"><%- recipients %></span>
                  <% } %>
                <% } %>
                <% if (smartDate == '__live__') { %>
                  <abbr style="border-bottom-style: none;" class="timeago tc-block-date" title="<%= (new Date(parseInt(dateCreated) * 1000)).toISOString() %>">
                    <%= (new Date(parseInt(dateCreated) * 1000)).toDateString() %>
                  </abbr>
                <% } else { %>
                  <abbr style="border-bottom-style: none;" class="tc-block-date"><%- smartDate %></abbr>
                <% } %>
              </div>
          </div>

          <div class="<%= sharedType == 'comment' && !orphaned && !ws.stream.noCollapse ? 'hidden ' : '' %>tc-block-content">
            <div class="clearfix">
              <% if (typeof rangeActions !== 'undefined') { %>
                <div class="tc-range-actions">
                  <% for(var i = 0; i < rangeActions.length; i++) { %>
                  <%= ws.stream.rangeActionTemplate(rangeActions[i]) %>
                  <% } %>
                </div>
              <% } %>
              <% if (description) { %>
                <p><%= description %></p>
              <% } %>
            </div>
          </div>

          <% if (replyPages.length > 0 && !(replyPages.length === 1 && replyPages[0].digests.length === 0)) { %>
            <div class="tc-timeline-comments">
            <% for (var i = 0; i < replyPages.length; i++) { %>
              <% if (i == 0 && replyPages[i].more) { %>
                <a href="#" class="tc-show-more" onclick="ws.stream.pageReplies(<%= id %>, <%= replyPages[i].page + 1 %>); return false">Show more replies (<%= replyPages[i].more %> hidden) </a>
              <% } else { %>
                <div></div>
              <% } %>
              <% for (var j = 0; j < replyPages[i].digests.length; j++) { %>
                <%= ws.stream.replyTemplate(replyPages[i].digests[j]) %>
              <% } %>
            <% } %>
            </div>
          <% } %>

          <% if ((ws.stream.userCanPostMessage && !locked) || ws.context.user.canAdministerWiki) { %>
          <div class="tc-add-comment media <%= ws.stream.noCollapse ? 'add-active' : ''%>">
            <img src="<%- ws.context.user.imageUrlPrefix %>lg.jpg" width="30" height="30" class="pull-left author-avatar" alt="" />
            <div class="media-body">
              <textarea name="reply" placeholder="Comment" class="form-control form-control-tc ws-reveal <%= !ws.stream.noCollapse ? 'ws-unrevealed' : ''%> reply" /></textarea>
              <button type="button" class="btn-tc btn-info-tc btn-sm-tc add-reply">Post</button>
            </div>
          </div>
          <% } %>
        </div>

      </div>
    </div>
  </div>
</script>

<script type="text/template" id="js-range-action-template">
  <div>
    <strong><%- name %></strong>
    <% if (typeof(diffUrl) !== 'undefined') { %>
      <a href="<%- diffUrl %>">
    <% } %>
    <%= new Date(dateCreated * 1000).toLocaleString() %>
    <% if (typeof(diffUrl) !== 'undefined') { %>
      </a>
    <% } %>
    <% if (typeof(rangeText) !== 'undefined') { %>
      <div>
        <span class="commentExtent">
        <% if (typeof(diffUrl) !== 'undefined') { %>
          <a href="<%- diffUrl %>">
        <% } %>
        <%= rangeText %>
        <% if (typeof(diffUrl) !== 'undefined') { %>
          </a>
        <% } %>
        </span>
      </div>
    <% } %>
  </div>
</script>

<script type="text/template" id="js-stream-end-template">
  <div class="tc-timeline-block tc-end-block">
    <div class="tc-timeline-icon" style="margin-top: -10px;" />
    <div class="tc-timeline-box" style="visibility: hidden;">
      <p class="tc-box-title"></p>
    </div>
  </div>
</script>

<a name="discussion"></a>
<div class="timeline WikispacesBs3 tc-timeline-embedded show-border">
  <div class="timeline-line"></div>
    <div id="js-share-list">
    <div class="spinner hidden"><i class="fa fa-spinner fa-spin"></i></div>
  </div>
</div></div></div><div id="sentinel" style="clear:both"></div>        </div>
      </main>
    </div>
  </div>
</div>

<footer class="ws-theme-footer" role="contentinfo">
  <div class="ws-theme-container">
    <div class="ws-theme-footer-inner">
      <div class="WikiFooterNav WikiElement">
<a href="http://helpcenter.wikispaces.com/" rel="nofollow" class="js-help-trigger">Help</a> &middot;
<a href="../www.wikispaces.com/about">About</a> &middot;
<a href="../www.wikispaces.com/content/pricing" rel="nofollow">Pricing</a> &middot;
<a href="../www.wikispaces.com/privacy" rel="nofollow">Privacy</a> &middot;
<a href="../www.wikispaces.com/terms" rel="nofollow">Terms</a> &middot;
<a href="../www.wikispaces.com/site/help?url=https%3A%2F%2Fcolour-recovery.wikispaces.com%2FUpdates%3FresponseToken%3D891fc83df167d9cbae86691b4e187d75" rel="nofollow"><strong>Support</strong></a> &middot;
<a href="/space/subscribe/upgrade"><strong>Upgrade</strong></a>
</div>      <div class="WikiLicense WikiElement">Contributions to https://colour-recovery.github.io/ are licensed under a <a rel="license" href="http://www.creativecommons.org/licenses/by-sa/2.5">Creative Commons Attribution Share-Alike 2.5 License</a>. <a rel="license" href="http://www.creativecommons.org/licenses/by-sa/2.5"><img src="../ssl.wikicdn.com/i/creativecommons/by-sa_2.5_80x15.png" width="85" height="15" alt="Creative Commons Attribution Share-Alike 2.5 License"/></a><br />Portions not contributed by visitors are Copyright 2018 Tangient LLC<br /><a href="https://www.tes.com/us/?utm_source=wikispaces&utm_medium=link&utm_campaign=US-52-footer">TES: The largest network of teachers in the world</a></div>    </div>
  </div>
</footer>


<script type="text/template" id="dialog-template">
<div class="modal fade" role="dialog" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="fa fa-times"></i></button>
        <h4 class="modal-title"><%= header %></h4>
      </div>
      <div class="modal-body">
        <%= body %>
      </div>
    </div>
  </div>
</div>
</script>


<div id="js-help-template" class="hidden">
  <div class="ws-help">
    <div class="js-help-controls WikispacesContent WikispacesBs3">
      <a href="../www.wikispaces.com/site/gettingstarted/off" class="btn btn-default hidden js-getting-started-off pull-right">Turn off "Getting Started"</a>
      <ol class="breadcrumb">
        <li class="js-special-breadcrumb active">
          <a href="http://helpcenter.wikispaces.com/" data-breadcrumb="0">Home</a>
        </li>
        <li class="js-ellipsis hidden js-special-breadcrumb">
          ...
        </li>
        <li class="js-spinner hidden js-special-breadcrumb"><i class="fa fa-spinner fa-spin"></i></li>
      </ol>
    </div>
    <div class="ws-help-content wiki">Loading...</div>
  </div>
</div>
</div>
<script src="../ssl.wikicdn.com/s/nogz/6q86j8zz-common.min.js" type="text/javascript"></script>
<script src="../ssl.wikicdn.com/s/nogz/70163536-editorc.min.js" type="text/javascript"></script>
<script src="../ssl.wikicdn.com/s/nogz/85k7018k-stream.min.js" type="text/javascript"></script>
<script src="../ssl.wikicdn.com/s/nogz/91k8z207-contentbar.min.js" type="text/javascript"></script>
<script src="../ssl.wikicdn.com/s/nogz/395j1vq7-component.stream-vo.min.js" type="text/javascript"></script>
<script type="text/javascript">
<!--
ws.namespace('ws.attributes');
ws.namespace('ws.stream');
ws.attributes.DISCUSSION_COUNT = 0;
ws.attributes.pageId = 35419115;
ws.attributes.version = 151532243;
ws.attributes.showEditor = true;
ws.attributes.editUrl = "https:\/\/colour-recovery.wikispaces.com\/page\/edit\/Updates?goto=https%3A%2F%2Fcolour-recovery.wikispaces.com%2FUpdates";
ws.attributes.userCanEdit = false;
ws.stream.userCanPostMessage = false;
ws.stream.hideTimeline = true;
ws.stream.shareSource = "https:\/\/colour-recovery.wikispaces.com\/page\/shares\/Updates";

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

jQuery(document).ready(function() {
  ws.common.addJsonNotices({"warning":[],"error":[],"info":[],"success":[]});
});

jQuery(document).ready(function() {
  ws.common.addNotice("<script type=\"text\/javascript\">function wsDismissBanner() { ws.common.removeNotice();  ws.cookie.set(\"wsFirstPartShutdown\", 1, {expires: 365 * 86400, domain: \".wikispaces.com\"}); return false;}$(\".ui-pnotify-closer\").remove();<\/script><i class=\"fa fa-times fa-fw ws-close\" onclick=\"wsDismissBanner();\"><\/i>It\u2019s time for us to say farewell\u2026 Classroom and Free Wikis are closing Soon!<br\/>Find out more about the full Wikispaces Site Closure <a href='http:\/\/blog.wikispaces.com' target='_top'>HERE<a\/>", "warning");
});

jQuery(document).ready(function($) {
  
  function tipPlacement() {
    return this.$element.closest('.ws-menu-bar .btn-group').is('.open') ? 'top' : 'bottom';
  }

  

  $('.ws-menu-bar').each(function() {
    var $menuBar = $(this);
    var $tagDropdown = $menuBar.find('.ws-tag-dropdown-menu');
    $menuBar.find('.tipme').tooltip({placement: tipPlacement, container: '.ws-menu-bar'});

    
    $menuBar.find('.ws-btn-more').click(ws.common.makeLinkClickFunction(function(e) {
      if ($(this).closest('.ws-menu-bar .btn-group').is('.open')) {
        ws.common.hideMorePageBar();
      } else {
        ws.common.showMorePageBar();
      }
    }));

    $menuBar.on('click', '.ws-tag-dropdown-toggle', ws.common.makeLinkClickFunction(function(e) {
      if ($(this).closest('.ws-menu-bar .dropdown').is('.open')) {
        ws.common.hideTagDropdown();
      } else {
        ws.common.showTagDropdown();
      }
    }));

    $(document.body).click(function(e) {
      var $target = $(e.target);
      if (!$target.closest('.ws-more-menu').closest('.ws-menu-bar').is($menuBar)
          || $target.closest('a').is('.WikispacesDialogLink')) {
        ws.common.hideMorePageBar();
      }
      if ($tagDropdown.length && !$target.closest('.ws-tag-dropdown-menu').is($tagDropdown)) {
        ws.common.hideTagDropdown();
      }
    });
    
  });
});


jQuery(document).ready(function($) {
  $('.ws-more-menu').on('click', 'a', function(e) {
    if ($(this).is('.disabled')) {
      e.preventDefault();
    }
  });
});


jQuery(document).ready(function() {
  ws.editor.canEdit = false;
  var editUrl = 'https://colour-recovery.github.io/page/edit/Updates?goto=https%3A%2F%2Fcolour-recovery.wikispaces.com%2FUpdates';

  jQuery('#js-edit-from-template').change(function() {
    window.location = ws.common.addUriParams(editUrl, [['template', jQuery(this).val()]]);
  });
});


jQuery(document).ready(function() {
  ws.editor.loadEditorLibs('../www.wikispaces.com/site/editorlibs/en/11kk95v9.js');
});


ws.editor.startEditor = function (moreCoreOptions, moreMainOptions) {
  ws.editor.canEdit = true;

  var coreOptions = {
    'content_css': ['../www.wikispaces.com/stylesheet/editori/217420326D.css']
  };

  // The stylesheet is passed in as a string, turn it into an array
  // Add bootstrap styles to the editor, if we are in a theme that has full screen bootstrap
  if (jQuery('body').is('.WikispacesBs3')) {
    coreOptions.content_css.push('../www.wikispaces.com//s/internal-bootstrap-body.css');
  }

  var mainOptions = {
    'wssave_cancel_url': '/Updates',
    'wsimage_upload_url': 'https://colour-recovery.github.io/file/multiupload',
    'wsimage_max_file_size_mb': '50',
    'wsimage_page_view_group': ''
  };

  ws.editor.loadEditor(jQuery.extend(coreOptions, moreCoreOptions), jQuery.extend(mainOptions, moreMainOptions));
};

  var wikispaces_page_version = '151532243';

  jQuery(document).ready(function() {
    ws.editor.enableButtons();
  });



--></script><!-- w23 164 wki:40:42(3) tot:164:164(1) mem:2:21(57) dql:2:12(9) mog:4:4(1) -->

</body>
</html>